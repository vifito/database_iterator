<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<title>Database Transversal API</title>
<link rel="stylesheet" type="text/css" href="media/style.css">
    
    <script type="text/javascript" src="js/sh_main.js"></script>
    <script type="text/javascript" src="js/lang/sh_php.js"></script>
    
    <link type="text/css" rel="stylesheet" href="media/sh_vim.css">


</head>
<body onload="sh_highlightDocument();">

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
    <td class="header_top">DatabaseIterator</td>
  </tr>
  <tr><td class="header_line"><img src="media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td class="header_menu">
        
                                    
                              		  [ <a href="classtrees_DatabaseIterator.html" class="menu">class tree: DatabaseIterator</a> ]
		  [ <a href="elementindex_DatabaseIterator.html" class="menu">index: DatabaseIterator</a> ]
		  	    [ <a href="elementindex.html" class="menu">all elements</a> ]
    </td>
  </tr>
  <tr><td class="header_line"><img src="media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="200" class="menu">
      <b>Packages:</b><br />
              <a href="li_DatabaseIterator.html">DatabaseIterator</a><br />
            <br /><br />
                        <b>Files:</b><br />
      	  <div class="package">
			<a href="DatabaseIterator/_database_iterator.class.php.html">		database_iterator.class.php
		</a><br>
	  </div><br />
      
      
            <b>Classes:</b><br />
        <div class="package">
		    		<a href="DatabaseIterator/ColumnIterator.html">ColumnIterator</a><br />
	    		<a href="DatabaseIterator/DatabaseIterator.html">DatabaseIterator</a><br />
	    		<a href="DatabaseIterator/RowIterator.html">RowIterator</a><br />
	    		<a href="DatabaseIterator/TableIterator.html">TableIterator</a><br />
	  </div>
                </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<div align="center"><h1>Database Transversal API</h1></div>

<div id="content">

<p style="width: 640px; font-size: 1.2em; padding: 8px; background-color: #EEE;">
    <strong>DatabaseIterator</strong> is a class that use new features of PHP5 (SPL, Iterators, magic methods, ...) to simplify process of iteration with a database. Using a DatabaseIterator, you can work with your database the same mode that you work with arrays.
</p>

<pre class="sh_php">
# Create an ADOConnection
require('../libs/adodb5/adodb.inc.php');
$conn = &ADONewConnection('mysql');
$conn->PConnect('localhost', 'root', 'pass', 'database');

# Create a DatabaseIterator instance
$databaseIt = new DatabaseIterator($conn);

# List tables
foreach($databaseIt as $table) {
    echo $table->name . PHP_EOL;
}

# Set an internal SQL and list rows using RowIterator::each() method
$databaseIt['contents']->select('pk_content, title')
    ->where('title REGEXP "[[.backslash.]]"');
$foo = create_function('$item', 'echo $item->title . PHP_EOL;');
$databaseIt['contents']->each($foo);

# Get CREATE TABLE syntax for current table
echo $databaseIt['contents']->getCreateTable();
echo $databaseIt->from('contents')->getCreateTable();

# Insert new data
for($i=0; $i&lt;10; $i++) {
    $std = new stdClass();
    $std->pk_evento = ($i+1);
    $std->fk_content_categories = 0;
    $std->summary = 'Testing '.$i;
    $std->body = 'Proba '.$i;
    $std->img = 0;
    
    $databaseIt['events']->insert($std);
}

# Alternative syntax
$row = $databaseIt['events']->newRow();
$row->insert($std);
o
$databaseIt['events']->insert($std);

# Update/delete a row
$databaseIt['events'][0]->summary = 'Hello';
$databaseIt['events'][0]->update();

$databaseIt['events'][0]->delete();


# Using adodb capabilities (transactions)
$conn->BeginTrans();
foreach($rows as $row) {
    $row->permalink = preg_replace('/[^a-zA-Z0-9_\-\/\.]/', '', $row->permalink);
    $row->update();
}
echo('Done.');

$conn->RollbackTrans(); // or $conn->CommitTrans();
</pre>
    
</div>

<br />
This documentation was generated by <a href="http://www.phpdoc.org">phpDocumentor v1.4.2</a><br />
        <div class="credit">
		    <hr />
		    Documentation generated on Mon, 25 May 2009 19:28:28 +0200 by <a href="http://www.phpdoc.org">phpDocumentor 1.4.2</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>